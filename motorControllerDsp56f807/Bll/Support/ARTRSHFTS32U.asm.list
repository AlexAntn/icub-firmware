Motorola DSP56800 Assembler  Version 6.3.16  110-11-03  12:48:55  C:\Software\iCub\firmware\controllerBll\Support\ARTRSHFTS32U.asm  Page 1



1                          ;----------------------------------------------------------------------
2                          ;  Metrowerks Embedded Runtime Support 1998 May
3                          ;
4                          ;       rtshift.asm
5                          ;
6                          ;               Copyright © 1998 Metrowerks, Inc.
7                          ;               All rights reserved.
8                          ;
9                          ;       Routines
10                         ;       --------
11                         ;       Fixed and integer 32 bit shifts (with and without REP instruction)
12                         ;       Algorithms taken from "DSP 56800 Family Manual" section 8.3
13                         ;
14                         ;----------------------------------------------------------------------
15                         ;
16     
17                                   section rtlib
18     
19                                   global  ARTRSHFTS32U
20                                   global  ARTRSHFTFXS32U
21     
22        P:000000                   org     p:
23                         ARTRSHFTS32U:
24                         ARTRSHFTFXS32U:
25        P:000000 8001              move              y0,x0
26        P:000001 81C0              andc    #$001f,x0                         ; perform a mod 32 shift.
                   FFE0
27        P:000003 8E00              tstw    x0
28        P:000004 A30B              beq     done                              ; if high bit of A is set, lsrr A,0 will put -1 in A2
29        P:000005 5E10              cmp     #16,x0                            ; if shift count is more than 16
30        P:000006 A503              blt     lt16_2                            ; do the shift in two steps:
31        P:000007 8086              move              a1,a0                   ; shift A 16-bits right
32        P:000008 860A              move              a2,a1
33        P:000009 A306              beq     done
34                         lt16_2:
35        P:00000A 8108              move              a0,y0
36        P:00000B 8306              move              a1,y1
37        P:00000C 754C              lsrr    y0,x0,A                           ; logically shift 16 the LSB
38        P:00000D 8086              move              a1,a0
39        P:00000E 860A              move              a2,a1                   ; clear a1
40        P:00000F 6D5C              asrac   y1,x0,A                           ; Add MSB shifted.
41                         done:
42        P:000010 EDD8              rts
43     
44                                   ENDSEC
45     
46                                   end

0    Errors
0    Warnings


